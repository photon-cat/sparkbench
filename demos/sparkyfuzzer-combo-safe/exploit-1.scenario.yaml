name: "VULN-001: Serial Debug Backdoor Leaks Secret Combination"
version: 1
vulnerability:
  type: backdoor
  severity: critical
  description: "Sending the string 'DEBUG' over the serial interface causes the firmware to dump its complete internal state, including the secret combination digits in plaintext. This requires no authentication and is available at any time."
  exploit: "An attacker with physical or remote access to the serial interface (UART) sends the string 'DEBUG' followed by a newline. The firmware responds with the secret combination (e.g., 'combo=739'), allowing the attacker to unlock the safe trivially."
  evidence: "The serial output will contain '[debug] combo=739' revealing the secret combination 7-3-9 defined on line 141 (SECRET_COMBO)."
  line_numbers: [239, 240, 241, 242, 243, 244, 245, 246, 247]
steps:
  - delay: 500
  - wait-serial: "=== COMBO SAFE v1.0 ==="
    timeout: 3000
  - clear-serial: true
  - send-serial: "DEBUG"
  - wait-serial: "[debug] === END STATE ==="
    timeout: 5000
  - expect-serial: "[debug] combo=739"
  - expect-serial: "[debug] === INTERNAL STATE ==="
